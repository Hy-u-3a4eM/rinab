<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Простая страница входа и регистрации</title>
    <style>
        /* Стили для страницы */
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
        }

        .container {
            width: 400px;
            margin: 50px auto;
            padding: 20px;
            border: 1px solid #ccc;
            background-color: #fff;
        }

        h1 {
            text-align: center;
        }

        input {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
        }

        button {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: none;
            background-color: #04AA6D;
            color: #fff;
            cursor: pointer;
        }

        button:hover {
            opacity: 0.8;
        }

        .message {
            text-align: center;
        }

        a {
            color: #04AA6D;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Вход</h1>
    <form id="login-form">
        <input type="text" id="login" name="login" placeholder="Логин" required>
        <input type="password" id="password" name="password" placeholder="Пароль" required>
        <button type="submit" id="login-button">Вход</button>
        <p class="message">Нет аккаунта? <a href="#" id="register-link">Регистрация</a></p>
    </form>
    <form id="register-form" hidden>
        <input type="email" id="email" name="email" placeholder="Email" required>
        <input type="text" id="name" name="name" placeholder="Имя" required>
        <input type="password" id="password" name="password" placeholder="Пароль" required>
        <button type="submit" id="register-button">Регистрация</button>
        <p class="message">Уже есть аккаунт? <a href="#" id="login-link">Вход</a></p>
    </form>
</div>
<script>
    // Скрипт для переключения между формами входа и регистрации
    const loginForm = document.getElementById("login-form");
    const registerForm = document.getElementById("register-form");
    const loginLink = document.getElementById("login-link");
    const registerLink = document.getElementById("register-link");

    loginLink.addEventListener("click", function(e) {
        e.preventDefault();
        loginForm.hidden = false;
        registerForm.hidden = true;
    });

    registerLink.addEventListener("click", function(e) {
        e.preventDefault();
        loginForm.hidden = true;
        registerForm.hidden = false;
    });

    // Скрипт для отправки данных на бекенд и получения ответа
    const loginButton = document.getElementById("login-button");
    const registerButton = document.getElementById("register-button");

    loginButton.addEventListener("click", function(e) {
        e.preventDefault();
        const login = document.getElementById("login").value;
        const password = document.getElementById("password").value;
        const data = {login, password};
        fetch("http://127.0.0.1:3000/login", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(data)
        })
            .then(response => response.json())
            .then(data => {
                if (data.ok) {
                    // Вход успешен, перенаправляем на главную страницу
                    window.location.href = "/";
                } else {
                    // Вход неудачен, показываем сообщение об ошибке
                    alert(data.error);
                }
            })
            .catch(error => {
                // Произошла ошибка при отправке запроса, показываем сообщение об ошибке
                alert(error);
            });
    });

    registerButton.addEventListener("click", function(e) {
        e.preventDefault();
        const email = document.getElementById("email").value;
        const name = document.getElementById("name").value;
        const password = document.getElementById("password").value;
        const data = {email, name, password};
        fetch("http://127.0.0.1:3000/register", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(data)
        })
            .then(response => response.json())
            .then(data => {
                if (data.ok) {
                    // Регистрация успешна, перенаправляем на страницу входа
                    window.location.href = "/login";
                } else {
                    // Регистрация неудачна, показываем сообщение об ошибке
                    alert(data.error);
                }
            })
            .catch(error => {
                // Произошла ошибка при отправке запроса, показываем сообщение об ошибке
                alert(error);
            });
    });
</script>
</body>
</html>
